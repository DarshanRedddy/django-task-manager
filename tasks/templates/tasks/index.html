{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task Manager</title>
    <link rel="stylesheet" href="{% static 'tasks/styles.css' %}">
</head>
<body>
<div class="container">
    <h1>🧠 Smart Task Manager</h1>

    <form method="get">
        <input type="text" name="search" placeholder="Search tasks..." value="{{ search }}">
        <select name="filter">
            <option value="">All</option>
            <option value="completed" {% if filter == 'completed' %}selected{% endif %}>Completed</option>
            <option value="pending" {% if filter == 'pending' %}selected{% endif %}>Pending</option>
        </select>
        <button type="submit">Filter</button>
    </form>

    <div class="stats">
        <strong>Total:</strong> {{ stats.total }} |
        <strong>Completed:</strong> {{ stats.completed }} |
        <strong>Pending:</strong> {{ stats.pending }} |
        <strong>Today:</strong> {{ stats.today }} |
        <strong>Overdue:</strong> {{ stats.overdue }}
    </div>

    <form method="POST" action="{% url 'add_task' %}">
        {% csrf_token %}
        <input type="text" name="title" placeholder="New task..." required>
        <input type="text" name="category" placeholder="Category">
        <input type="date" name="due_date">
        <select name="priority">
            <option value="High">High</option>
            <option value="Medium" selected>Medium</option>
            <option value="Low">Low</option>
        </select>
        <select name="repeat">
            <option value="None" selected>None</option>
            <option value="Daily">Daily</option>
            <option value="Weekly">Weekly</option>
            <option value="Monthly">Monthly</option>
        </select>
        <button type="submit">➕ Add</button>
    </form>

    <ul class="task-list">
        {% for task in tasks %}
            <li>
                {% if task.completed %}
                    <s>{{ task.title }}</s>
                {% else %}
                    {{ task.title }}
                {% endif %}
                <small> | {{ task.category }} | Due: {{ task.due_date }} | Priority: {{ task.priority }}</small>
                <span class="task-actions">
                    <a href="{% url 'toggle_complete' task.id %}">✅</a>
                    <a href="{% url 'delete_task' task.id %}" onclick="return confirm('Delete task?')">❌</a>
                </span>
            </li>
        {% endfor %}
    </ul>

    <form method="POST" action="{% url 'clear_all' %}">
        {% csrf_token %}
        <button type="submit" onclick="return confirm('Clear all tasks?')">🧽 Clear All</button>
    </form>
</div>
</body>
</html>
